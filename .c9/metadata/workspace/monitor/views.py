{"filter":false,"title":"views.py","tooltip":"/monitor/views.py","undoManager":{"mark":41,"position":41,"stack":[[{"start":{"row":19,"column":43},"end":{"row":20,"column":0},"action":"insert","lines":["",""],"id":125},{"start":{"row":20,"column":0},"end":{"row":20,"column":1},"action":"insert","lines":["\t"]}],[{"start":{"row":20,"column":1},"end":{"row":21,"column":0},"action":"insert","lines":["",""],"id":126},{"start":{"row":21,"column":0},"end":{"row":21,"column":1},"action":"insert","lines":["\t"]}],[{"start":{"row":21,"column":0},"end":{"row":21,"column":1},"action":"remove","lines":["\t"],"id":127}],[{"start":{"row":21,"column":0},"end":{"row":49,"column":44},"action":"insert","lines":["class GetGrapidAPIView(View):","     ","    def get(self, request, hostid):","        try:","            hostinfo = GameHost.objects.using('res').get(id=hostid)","            if hostinfo.platid == 34:","                hostip = hostinfo.ip2","            else:","                hostip = hostinfo.ip1","            print \"hostip: %s\" % hostip","             ","            ret = []","            for key in ['system.cpu.util[,idle]', 'net.if.in[eth0]|net.if.in[em1]', 'vm.memory.size[available]', 'icmpping']:","                if '|' in key:","                    key1, key2 = key.split('|')","                    #获取itemid：","                    itemid = Items.objects.using('zab').get(Q(key_field=key1)|Q(key_field=key2), hostid__host=hostip).itemid         ","                else:","                    #获取itemid：","                    itemid = Items.objects.using('zab').get(key_field=key, hostid__host=hostip).itemid ","                print \"itemid: %s\" % itemid","                graphitems = GraphsItems.objects.using('zab').filter(itemid=itemid)[0]","                graphid = graphitems.graphid.graphid","                print \"graphid: %s\" % graphid","                ret.append(graphid)","        except Exception,e:","            print e","            ret = []","        return HttpResponse(json.dumps(ret))"],"id":128}],[{"start":{"row":1,"column":44},"end":{"row":1,"column":45},"action":"insert","lines":["，"],"id":129}],[{"start":{"row":1,"column":45},"end":{"row":1,"column":46},"action":"insert","lines":["V"],"id":130}],[{"start":{"row":1,"column":46},"end":{"row":1,"column":49},"action":"insert","lines":["iew"],"id":131}],[{"start":{"row":1,"column":44},"end":{"row":1,"column":45},"action":"remove","lines":["，"],"id":132},{"start":{"row":1,"column":44},"end":{"row":1,"column":45},"action":"insert","lines":[","]}],[{"start":{"row":1,"column":45},"end":{"row":1,"column":46},"action":"insert","lines":[" "],"id":133}],[{"start":{"row":1,"column":45},"end":{"row":1,"column":46},"action":"remove","lines":[" "],"id":134}],[{"start":{"row":1,"column":49},"end":{"row":2,"column":0},"action":"insert","lines":["",""],"id":135}],[{"start":{"row":2,"column":0},"end":{"row":2,"column":32},"action":"insert","lines":["from django.views.generic import"],"id":136}],[{"start":{"row":2,"column":32},"end":{"row":2,"column":33},"action":"insert","lines":[" "],"id":137}],[{"start":{"row":2,"column":33},"end":{"row":2,"column":34},"action":"insert","lines":["V"],"id":138}],[{"start":{"row":2,"column":34},"end":{"row":2,"column":35},"action":"insert","lines":["i"],"id":139}],[{"start":{"row":2,"column":35},"end":{"row":2,"column":36},"action":"insert","lines":["e"],"id":140}],[{"start":{"row":2,"column":36},"end":{"row":2,"column":37},"action":"insert","lines":["w"],"id":141}],[{"start":{"row":1,"column":44},"end":{"row":1,"column":49},"action":"remove","lines":[",View"],"id":142}],[{"start":{"row":1,"column":44},"end":{"row":2,"column":0},"action":"remove","lines":["",""],"id":143}],[{"start":{"row":1,"column":44},"end":{"row":2,"column":0},"action":"insert","lines":["",""],"id":144}],[{"start":{"row":1,"column":44},"end":{"row":1,"column":45},"action":"insert","lines":[","],"id":145}],[{"start":{"row":1,"column":45},"end":{"row":1,"column":57},"action":"insert","lines":["HttpResponse"],"id":146}],[{"start":{"row":1,"column":44},"end":{"row":1,"column":57},"action":"remove","lines":[",HttpResponse"],"id":147},{"start":{"row":1,"column":44},"end":{"row":2,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":2,"column":0},"end":{"row":2,"column":97},"action":"insert","lines":["from django.shortcuts import render,render_to_response,redirect,HttpResponseRedirect,HttpResponse"],"id":148}],[{"start":{"row":2,"column":36},"end":{"row":2,"column":55},"action":"remove","lines":["render_to_response,"],"id":149}],[{"start":{"row":10,"column":28},"end":{"row":11,"column":0},"action":"insert","lines":["",""],"id":150}],[{"start":{"row":11,"column":0},"end":{"row":11,"column":1},"action":"insert","lines":["i"],"id":151}],[{"start":{"row":11,"column":1},"end":{"row":11,"column":2},"action":"insert","lines":["m"],"id":152}],[{"start":{"row":11,"column":2},"end":{"row":11,"column":3},"action":"insert","lines":["p"],"id":153}],[{"start":{"row":11,"column":3},"end":{"row":11,"column":4},"action":"insert","lines":["o"],"id":154}],[{"start":{"row":11,"column":4},"end":{"row":11,"column":5},"action":"insert","lines":["r"],"id":155}],[{"start":{"row":11,"column":5},"end":{"row":11,"column":6},"action":"insert","lines":["t"],"id":156}],[{"start":{"row":11,"column":6},"end":{"row":11,"column":7},"action":"insert","lines":[" "],"id":157}],[{"start":{"row":11,"column":7},"end":{"row":11,"column":8},"action":"insert","lines":["j"],"id":158}],[{"start":{"row":11,"column":8},"end":{"row":11,"column":9},"action":"insert","lines":["s"],"id":159}],[{"start":{"row":11,"column":9},"end":{"row":11,"column":10},"action":"insert","lines":["o"],"id":160}],[{"start":{"row":11,"column":10},"end":{"row":11,"column":11},"action":"insert","lines":["n"],"id":161}],[{"start":{"row":28,"column":26},"end":{"row":28,"column":27},"action":"remove","lines":["e"],"id":162}],[{"start":{"row":28,"column":25},"end":{"row":28,"column":26},"action":"remove","lines":["m"],"id":163}],[{"start":{"row":28,"column":24},"end":{"row":28,"column":25},"action":"remove","lines":["a"],"id":164}],[{"start":{"row":28,"column":23},"end":{"row":28,"column":24},"action":"remove","lines":["G"],"id":165}],[{"start":{"row":28,"column":27},"end":{"row":28,"column":28},"action":"insert","lines":["s"],"id":166}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":29,"column":37},"end":{"row":29,"column":37},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1453944681000,"hash":"1b33f3eeb22f2fb08b438bbf4756401d2c33e70d"}